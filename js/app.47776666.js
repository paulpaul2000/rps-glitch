(function(e){function t(t){for(var r,o,s=t[0],c=t[1],u=t[2],d=0,v=[];d<s.length;d++)o=s[d],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&v.push(i[o][0]),i[o]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);l&&l(t);while(v.length)v.shift()();return a.push.apply(a,u||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,s=1;s<n.length;s++){var c=n[s];0!==i[c]&&(r=!1)}r&&(a.splice(t--,1),e=o(o.s=n[0]))}return e}var r={},i={app:0},a=[];function o(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=r,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var l=c;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},1:function(e,t){},2:function(e,t){},3:function(e,t){},4:function(e,t){},5:function(e,t){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d"),n("99af");var r=n("2b0e"),i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-app",[n("v-app-bar",{attrs:{app:"",dark:""}},[n("div",[n("span",{staticClass:"font-weight-black"},[e._v("ROCK PAPER SCISSORS")])]),n("v-spacer"),e.loggedIn?n("v-chip",{staticClass:"ma-2",attrs:{outlined:"",pill:""}},[e._v(" Logged in as "+e._s(e.username)+" "),e.loggedIn?n("button",{on:{click:e.logout}},[n("v-icon",{attrs:{right:""}},[e._v("mdi-logout")])],1):e._e()]):e._e()],1),n("v-main",[n("router-view")],1),n("v-footer",{attrs:{padless:""}},[n("v-col",{staticClass:"text-center",attrs:{cols:"12"}},[e._v(" 2021 — © "),n("strong",[e._v("CDS")])])],1)],1)},a=[],o={name:"App",data:function(){return{}},methods:{logout:function(){this.$store.dispatch("logout")}},computed:{loggedIn:function(){return this.$store.getters.loggedIn},username:function(){return this.$store.getters.username}}},s=o,c=n("2877"),u=n("6544"),l=n.n(u),d=n("7496"),v=n("40dc"),m=n("cc20"),f=n("62ad"),h=n("553a"),p=n("132d"),b=n("f6c4"),g=n("2fa4"),_=Object(c["a"])(s,i,a,!1,null,null,null),k=_.exports;l()(_,{VApp:d["a"],VAppBar:v["a"],VChip:m["a"],VCol:f["a"],VFooter:h["a"],VIcon:p["a"],VMain:b["a"],VSpacer:g["a"]});n("b0c0");var x=n("8c4f"),w=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-card",{staticClass:"mx-auto",staticStyle:{width:"60%"}},["idle"==e.screen?n("div",[n("idle")],1):"match"==e.screen?n("div",[n("match")],1):"result"==e.screen?n("div",[n("result")],1):e._e()])},y=[],O=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("v-card-text",[0!=e.counter?n("div",{staticClass:"text-h1 text-center"},[e._v(" "+e._s(e.counter)+" ")]):e._e(),0!=e.counter||e.turn?e._e():n("div",{staticClass:"d-flex pa-2 justify-center"},["buttons"==e.mode?n("v-card-actions",[n("v-btn",{on:{click:function(t){return e.makeTurn("rock")}}},[e._v("Rock")]),n("v-btn",{on:{click:function(t){return e.makeTurn("paper")}}},[e._v("Paper")]),n("v-btn",{on:{click:function(t){return e.makeTurn("scissors")}}},[e._v("Scissors")])],1):e._e(),"gesture"==e.mode?n("gesture",{on:{gesture:e.makeTurn}}):e._e(),"speech"==e.mode?n("speech",{on:{word:e.makeTurn}}):e._e()],1),e.turn?n("div",[n("v-card-title",[e._v("Your choice: "+e._s(e.turn))]),n("v-card-subtitle",[e._v("Waiting for opponent...")])],1):e._e()])],1)},V=[],C=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-card-text",[n("v-select",{attrs:{items:e.devices,"item-text":"label","item-value":"deviceId"},model:{value:e.videoDevice,callback:function(t){e.videoDevice=t},expression:"videoDevice"}}),n("video",{ref:"video"}),n("div",[n("table",e._l(e.predictions,(function(t,r){return n("tr",{key:r},[n("td",[n("label",{attrs:{for:t.name}},[e._v(e._s(t.name))])]),n("td",[n("meter",{attrs:{id:t.name,value:t.score,min:"0",max:"100"}})])])})),0)])],1)},T=[],j=n("b85c"),R=(n("159b"),n("4de4"),n("d3b7"),n("a434"),n("b680"),n("ce1a")),M=n("080e"),S={name:"App",components:{},data:function(){return{videoDevice:"",devices:[],baseModel:"mobilenet_v2",isModelReady:!1,predictions:[{name:"Rock",score:0},{name:"Paper",score:0},{name:"Scissors",score:0}],lastPrediction:""}},mounted:function(){var e=this;R["setBackend"]("webgl"),this.listVideoDevices().then((function(t){var n,r=Object(j["a"])(t);try{for(r.s();!(n=r.n()).done;){var i=n.value;e.devices.push(i)}}catch(a){r.e(a)}finally{r.f()}e.videoDevice=t[0].deviceId})).then((function(){return e.initWebcamStream()})).then((function(){return e.loadModel().then((function(){e.detectObjects()}))}))},beforeDestroy:function(){if(this.raf){var e=this.$refs.video;e.pause(),e.srcObject=null,this.stream.getTracks().forEach((function(e){e.stop()})),this.isVideoStreamReady=!1,cancelAnimationFrame(this.raf)}},methods:{listVideoDevices:function(){return navigator.mediaDevices.enumerateDevices().then((function(e){return e.filter((function(e){return"videoinput"===e.kind}))}))},initWebcamStream:function(){var e=this;if(this.isVideoStreamReady=!1,navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)return navigator.mediaDevices.getUserMedia({video:{deviceId:this.videoDevice}}).then((function(t){e.stream=t;var n=e.$refs.video;return n.srcObject=e.stream,new Promise((function(t){n.onloadedmetadata=function(){e.videoRatio=n.videoHeight/n.videoWidth,e.isVideoStreamReady=!0,n.play(),t()}}))})).catch((function(e){console.log("failed to initialize webcam stream",e)}))},loadModel:function(){var e=this;return M["load"]("/gesture/model.json","/gesture/metadata.json").then((function(t){e.model=t,e.isModelReady=!0})).catch((function(e){throw console.log("failed to load the mode",e),e}))},detectObjects:function(){var e=this;this.isModelReady&&(this.isVideoStreamReady?this.model.predict(this.$refs.video).then((function(t){e.handlePredictions(t),e.raf=requestAnimationFrame((function(){e.detectObjects()}))})):this.raf=requestAnimationFrame((function(){e.detectObjects()})))},handlePredictions:function(e){var t,n=this;this.predictions.splice(0);var r=0;e.forEach((function(e){n.predictions.push({name:e.className,score:(100*e.probability).toFixed(1)}),e.probability>r&&(r=e.probability,t=e)})),this.lastPrediction!=t.className&&(this.lastPrediction=t.className,this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout((function(){"Nothing"!=n.lastPrediction&&n.$emit("gesture",n.lastPrediction.toLowerCase())}),1500))}}},P=S,E=(n("aeb3"),n("99d9")),D=n("b974"),$=Object(c["a"])(P,C,T,!1,null,null,null),I=$.exports;l()($,{VCardText:E["c"],VSelect:D["a"]});var A=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-card-text",[n("v-select",{attrs:{items:e.audioDevices,"item-text":"label","item-value":"deviceId"},model:{value:e.audioDevice,callback:function(t){e.audioDevice=t},expression:"audioDevice"}}),n("v-simple-table",[n("tbody",[null!=e.topPrediction?n("tr",[n("td",[e._v(e._s(e.topPrediction.name))]),n("td",[e._v(e._s(e.topPrediction.score)+" %")])]):n("tr",[n("td",[e._v("Not sure...")])]),e._l(e.filteredSortedPredictions,(function(t,r){return n("tr",{key:r},[n("td",[e._v(e._s(t.name))]),n("td",[e._v(e._s(t.score)+" %")])])}))],2)])],1)},L=[],U=n("1da1"),q=n("2909"),z=(n("96cf"),n("af3e")),N={name:"App",data:function(){return{isModelReady:!1,predictions:[],audioTrackConstraints:{},audioDevices:[],audioDevice:""}},watch:{audioDevice:function(e){this.recognizer&&this.setupRecognizer(e)}},computed:{sortedPredictions:function(){var e=Object(q["a"])(this.predictions);return e.sort((function(e,t){return t.score-e.score})),e},topPrediction:function(){return this.sortedPredictions.length>0?this.sortedPredictions[0]:null},filteredSortedPredictions:function(){var e=this.topPrediction;return this.sortedPredictions.filter((function(t){return t!=e}))}},mounted:function(){var e=this;return Object(U["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:R["setBackend"]("webgl"),n=navigator.mediaDevices.enumerateDevices(),n.then(function(){var t=Object(U["a"])(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n.forEach((function(t){"audioinput"===t.kind&&e.audioDevices.push(t)})),e.audioDevice=e.audioDevices[0].deviceId,t.next=4,e.createModel();case 4:e.recognizer=t.sent,e.classLabels=e.recognizer.wordLabels(),e.setupRecognizer(e.audioDevice);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 3:case"end":return t.stop()}}),t)})))()},beforeDestroy:function(){this.recognizer&&this.recognizer.stopListening()},methods:{setupRecognizer:function(e){var t=this;return Object(U["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!t.recognizer.isListening()){n.next=3;break}return n.next=3,t.recognizer.stopListening();case 3:return n.next=5,t.recognizer.listen((function(e){t.handlePredictions(e.scores)}),{includeSpectrogram:!1,probabilityThreshold:.75,invokeCallbackOnNoiseAndUnknown:!0,overlapFactor:.5,audioTrackConstraints:{deviceId:e}});case 5:case"end":return n.stop()}}),n)})))()},createModel:function(){return Object(U["a"])(regeneratorRuntime.mark((function e(){var t,n,r,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t="".concat(location.protocol,"//").concat(location.host),n="".concat(t,"/speech/model.json"),r="".concat(t,"/speech/metadata.json"),i=z["a"]("BROWSER_FFT",void 0,n,r),e.next=6,i.ensureModelLoaded();case 6:return e.abrupt("return",i);case 7:case"end":return e.stop()}}),e)})))()},handlePredictions:function(e){var t=this;this.predictions.length=0,e.forEach((function(e,n){t.predictions.push({name:t.classLabels[n],score:(100*e).toFixed(1)})}));var n=this.topPrediction;"Background Noise"!==n.name&&this.$emit("word",n.name.toLowerCase())}}},B=N,F=(n("ca8a"),n("1f4f")),G=Object(c["a"])(B,A,L,!1,null,null,null),W=G.exports;l()(G,{VCardText:E["c"],VSelect:D["a"],VSimpleTable:F["a"]});var H={components:{Gesture:I,Speech:W},data:function(){return{counter:3}},mounted:function(){var e=this,t=setInterval((function(){e.counter--,0==e.counter&&clearInterval(t)}),1e3)},methods:{makeTurn:function(e){this.$store.dispatch("makeTurn",{turn:e})}},computed:{turn:function(){return this.$store.state.turn},mode:function(){return this.$store.state.mode}}},Y=H,J=n("8336"),K=n("a523"),Q=Object(c["a"])(Y,O,V,!1,null,null,null),X=Q.exports;l()(Q,{VBtn:J["a"],VCardActions:E["a"],VCardSubtitle:E["b"],VCardText:E["c"],VCardTitle:E["d"],VContainer:K["a"]});var Z=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("v-card-title",[e._v("Choose your opponent!")]),n("v-card-text",[e.users.length>0?n("v-list",[n("v-list-item-group",{attrs:{color:"primary"}},e._l(e.users,(function(t,r){return n("v-list-item",{key:r,on:{click:function(n){return e.requestMatch(t)}}},[n("v-list-item-icon",[t.matchRequest==e.user.username?n("v-icon",[e._v("mdi-flag")]):n("v-icon",[e._v("mdi-account")])],1),n("v-list-item-content",[t.matchRequest==e.user.username?n("v-list-item-title",[e._v(e._s(t.username)+" wants to play")]):n("v-list-item-title",[e._v(e._s(t.username))])],1)],1)})),1)],1):e._e(),0==e.users.length?n("v-banner",{attrs:{elevation:"2",icon:"mdi-account"}},[e._v(" No players available ")]):e._e()],1)],1)},ee=[],te={name:"Home",methods:{requestMatch:function(e){this.$store.dispatch("requestMatch",e)}},computed:{users:function(){var e=this;return this.$store.state.users.filter((function(t){return t.username!==e.user.username})).filter((function(e){return 0==e.inMatch}))},user:function(){return this.$store.state.user}}},ne=te,re=n("e4e5"),ie=n("8860"),ae=n("da13"),oe=n("5d23"),se=n("1baa"),ce=n("34c3"),ue=Object(c["a"])(ne,Z,ee,!1,null,"6328e75f",null),le=ue.exports;l()(ue,{VBanner:re["a"],VCardText:E["c"],VCardTitle:E["d"],VContainer:K["a"],VIcon:p["a"],VList:ie["a"],VListItem:ae["a"],VListItemContent:oe["a"],VListItemGroup:se["a"],VListItemIcon:ce["a"],VListItemTitle:oe["b"]});var de=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"about"},[n("v-card-title",[e._v("Result")]),n("v-card-text",[n("v-simple-table",[n("thead",[n("tr",[n("th",{staticClass:"text-center"},[e._v("Username")]),n("th",{staticClass:"text-center"},[e._v("Turn")])])]),n("tbody",e._l(e.result.players,(function(t,r){return n("tr",{key:r},[n("td",{staticClass:"text-center"},[e._v(e._s(t.username))]),n("td",{staticClass:"text-center"},[e._v(e._s(t.turn))])])})),0)]),n("v-banner",{attrs:{elevation:"2",color:"rgb(200,200,200)"}},[e.result.winner?n("div",{staticClass:"font-weight-bold text-center"},[e._v(e._s(e.result.winner.username)+" wins!")]):e._e(),null==e.result.winner?n("div",{staticClass:"font-weight-bold text-center"},[e._v("Draw!")]):e._e()])],1),n("v-card-actions",[n("v-btn",{on:{click:e.newMatch}},[e._v("Start a new match")])],1)],1)},ve=[],me={methods:{newMatch:function(){this.$store.dispatch("newMatch")}},computed:{result:function(){return this.$store.state.result}}},fe=me,he=Object(c["a"])(fe,de,ve,!1,null,null,null),pe=he.exports;l()(he,{VBanner:re["a"],VBtn:J["a"],VCardActions:E["a"],VCardText:E["c"],VCardTitle:E["d"],VSimpleTable:F["a"]});var be={name:"Game",components:{Match:X,Idle:le,Result:pe},computed:{screen:function(){return this.$store.state.screen}}},ge=be,_e=n("b0af"),ke=Object(c["a"])(ge,w,y,!1,null,"4b7e5bbb",null),xe=ke.exports;l()(ke,{VCard:_e["a"]});var we=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-card",{staticClass:"mx-auto",staticStyle:{width:"60%"}},[n("v-card-title",[e._v("Enter your username")]),n("v-card-text",[n("v-text-field",{attrs:{label:"Username","prepend-icon":"mdi-account-circle"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.enterGame(t)}},model:{value:e.username,callback:function(t){e.username="string"===typeof t?t.trim():t},expression:"username"}}),n("v-alert",{attrs:{border:"top",color:"red lighten-2",dark:""},model:{value:e.userExists,callback:function(t){e.userExists=t},expression:"userExists"}},[e._v(" Username already taken ")])],1),n("v-card-title",[e._v("Choose an interaction mode")]),n("v-card-text",[n("v-radio-group",{model:{value:e.mode,callback:function(t){e.mode=t},expression:"mode"}},[n("v-radio",{attrs:{value:"buttons",label:"Buttons"}}),n("v-radio",{attrs:{value:"gesture",label:"Gestures"}}),n("v-radio",{attrs:{value:"speech",label:"Speech"}})],1)],1),n("v-card-actions",[n("v-btn",{attrs:{color:"success"},on:{click:e.enterGame}},[e._v("Enter game")])],1)],1)},ye=[],Oe={name:"Login",data:function(){return{username:""}},methods:{enterGame:function(){""!=this.username&&this.$store.dispatch("login",this.username)}},computed:{userExists:function(){return this.$store.state.invalidUser},mode:{get:function(){return this.$store.state.mode},set:function(e){this.$store.dispatch("setMode",e)}}}},Ve=Oe,Ce=n("0798"),Te=n("67b6"),je=n("43a6"),Re=n("8654"),Me=Object(c["a"])(Ve,we,ye,!1,null,"7cce28b5",null),Se=Me.exports;l()(Me,{VAlert:Ce["a"],VBtn:J["a"],VCard:_e["a"],VCardActions:E["a"],VCardText:E["c"],VCardTitle:E["d"],VRadio:Te["a"],VRadioGroup:je["a"],VTextField:Re["a"]});var Pe,Ee=n("ade3"),De=n("2f62"),$e=n("0e44"),Ie="LOGIN_PLAYER",Ae="LOGOUT_PLAYER",Le="PLAYER_EXISTS",Ue="UPDATE_PLAYERS",qe="START_MATCH",ze="MAKE_TURN",Ne="MATCH_REQUESTED",Be="END_MATCH",Fe="NEW_MATCH",Ge="SET_MODE";r["a"].use(De["a"]);var We=new De["a"].Store({plugins:[Object($e["a"])()],state:{user:null,users:[],screen:"login",invalidUser:!1,inMatchWith:null,winner:null,matchRequest:null,turn:null,mode:"buttons",result:null},mutations:(Pe={},Object(Ee["a"])(Pe,Ie,(function(e,t){e.user=t,e.screen="idle",e.invalidUser=!1,e.inMatchWith=null,e.matchRequest=null,e.turn=null})),Object(Ee["a"])(Pe,Ae,(function(e){e.user=null})),Object(Ee["a"])(Pe,Le,(function(e){e.invalidUser=!0})),Object(Ee["a"])(Pe,Ue,(function(e,t){e.users=t})),Object(Ee["a"])(Pe,qe,(function(e,t){e.inMatchWith=t,e.matchRequest=null,e.screen="match"})),Object(Ee["a"])(Pe,ze,(function(e,t){e.turn=t.turn})),Object(Ee["a"])(Pe,Be,(function(e,t){e.result=t,e.screen="result"})),Object(Ee["a"])(Pe,Fe,(function(e){e.winner=null,e.turn=null,e.result=null,e.screen="idle"})),Object(Ee["a"])(Pe,Ne,(function(e,t){e.matchRequest=t})),Object(Ee["a"])(Pe,Ge,(function(e,t){e.mode=t})),Pe),actions:{login:function(e,t){this.socket.emit("login",t)},logout:function(e){var t=e.state;this.socket.emit("logout",t.user.username)},requestMatch:function(e,t){var n=e.commit;n(Ne,t),this.socket.emit("requestMatch",{opponent:t})},makeTurn:function(e,t){var n=e.commit;n(ze,t),this.socket.emit("makeTurn",{turn:t})},newMatch:function(e){var t=e.commit;t(Fe),this.socket.emit("newMatch")},setMode:function(e,t){var n=e.commit;n(Ge,t)},socket_userLoggedIn:function(e,t){var n=e.commit;n(Ie,t),Ke.push({name:"game"}).catch((function(){}))},socket_userExists:function(e){var t=e.commit;t(Le)},socket_userLoggedOut:function(e,t){var n=e.commit;n(Ae,t),Ke.push({name:"login"}).catch((function(){}))},socket_players:function(e,t){var n=e.commit;n(Ue,t)},socket_startMatch:function(e,t){var n=e.commit;n(qe,t)},socket_matchResult:function(e,t){var n=e.commit;n(Be,t)}},getters:{loggedIn:function(e){return null!==e.user},username:function(e){return e.user.username}}}),He=We;r["a"].use(x["a"]);var Ye=[{path:"/login",name:"login",component:Se},{path:"/game",name:"game",component:xe}],Je=new x["a"]({mode:"history",base:"/",routes:Ye});Je.beforeEach((function(e,t,n){He.getters.loggedIn&&"login"==e.name?n("game"):He.getters.loggedIn||"login"==e.name?n():n("login")}));var Ke=Je,Qe=n("5132"),Xe=n.n(Qe),Ze=n("8e27"),et=n.n(Ze),tt=n("f309");r["a"].use(tt["a"]);var nt=new tt["a"]({}),rt="".concat(window.location.protocol,"//").concat(window.location.hostname,":8081");rt="https://rps-cds.glitch.me";var it=et()(rt,{});He.socket=it,null!=He.state.user&&He.dispatch("login",He.state.user.username);var at=new Xe.a({debug:!1,connection:it,vuex:{store:He,actionPrefix:"socket_"}});r["a"].use(at),r["a"].config.productionTip=!1,new r["a"]({router:Ke,store:He,vuetify:nt,render:function(e){return e(k)}}).$mount("#app")},6:function(e,t){},7:function(e,t){},"92c0":function(e,t,n){},aeb3:function(e,t,n){"use strict";n("92c0")},ca8a:function(e,t,n){"use strict";n("d02b")},d02b:function(e,t,n){}});
//# sourceMappingURL=app.47776666.js.map